import{R as n,j as e,m as $}from"./index-CVxrc5Ku.js";import{g as u}from"./client-DYrIeA2N.js";function h(s){return(Array.isArray(s)?s:Array.isArray(s?.data)?s.data:[]).map(a=>({id:a.id??a.uuid??a._id??Math.random().toString(36).slice(2),title:a.title||a.name||"Untitled",url:a.url||a.link||"",description:a.description||a.desc||"",tags:Array.isArray(a.tags)?a.tags:String(a.tags||"").split(/[,\s]+/).filter(Boolean)}))}async function J(s=""){const o=s&&s.trim()?s.trim():"*";try{const a=await u(`/api/resources?q=${encodeURIComponent(o)}`);return h(a)}catch(a){try{const i=await u("/api/resources");return h(i)}catch{try{const c=await u("/api/resources?q=");return h(c)}catch{throw a}}}}const E="teacher_console_state_v1",R="teacher_console_groupnote_v1",T=s=>/^https?:\/\//i.test(String(s||""))?String(s):"",C=[{id:1,name:"Айдана Т.",grade:"",present:!1,note:""},{id:2,name:"Мируан С.",grade:"",present:!1,note:""},{id:3,name:"Әмина Қ.",grade:"",present:!1,note:""},{id:4,name:"Нұрасыл А.",grade:"",present:!1,note:""}];function D(){try{return JSON.parse(localStorage.getItem(E)||"null")||C}catch{return C}}function K(s){localStorage.setItem(E,JSON.stringify(s))}function Q(){const[s,o]=n.useState(D),[a,i]=n.useState(()=>localStorage.getItem(R)||"");n.useEffect(()=>{K(s)},[s]),n.useEffect(()=>{localStorage.setItem(R,a||"")},[a]);const c=(t,r)=>o(l=>l.map(p=>p.id===t?{...p,...r}:p)),g=t=>o(r=>r.map(l=>({...l,present:t}))),A=()=>o(t=>t.map(r=>({...r,grade:"",note:""}))),O=s.filter(t=>t.present).length,_=()=>{const t={date:new Date().toISOString(),groupNote:a,students:s},r=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),l=document.createElement("a");l.href=URL.createObjectURL(r),l.download=`teacher-console-${new Date().toISOString().slice(0,10)}.json`,l.click(),URL.revokeObjectURL(l.href)},[x,f]=n.useState(s[0]?.id??1);n.useEffect(()=>{!s.find(t=>t.id===Number(x))&&s[0]&&f(s[0].id)},[s,x]);const d=s.find(t=>t.id===Number(x)),L=d?`Сәлеметсіз бе! ${d.name} бүгін сабаққа ${d.present?"қатысты":"қатыспады"}.
Соңғы баға: ${d.grade||"—"}. Мұғалім ескертпесі: ${d.note||"жоқ"}.`:"",[b,I]=n.useState(""),[j,N]=n.useState([]),[m,y]=n.useState(!1),[v,S]=n.useState(""),w=async(t="")=>{y(!0),S("");try{const r=await J(t.trim());N(r)}catch(r){S(r?.message||"Ресурстарды жүктеу мүмкін емес."),N([])}finally{y(!1)}};n.useEffect(()=>{w("*")},[]);const k=()=>w(b),U=t=>{t.key==="Enter"&&k()};return e.jsxs("div",{className:"container mx-auto max-w-6xl px-4 py-10",children:[e.jsxs($.h1,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},className:"text-3xl md:text-4xl font-extrabold text-slate-900",children:["Ақылды көмекші — ",e.jsx("span",{className:"text-[#7c3aed]",children:"Teacher Console"})]}),e.jsxs("p",{className:"mt-2 text-slate-600",children:["Журнал, қатысу, жедел бағалау және ата-анаға қысқа есеп. Барлық өзгерістер құрылғыда ",e.jsx("b",{children:"жергілікті"})," сақталады."]}),e.jsxs("div",{className:"mt-6 flex flex-wrap gap-3",children:[e.jsx("button",{onClick:()=>g(!0),className:"px-4 py-2 rounded-xl bg-emerald-600 text-white font-semibold",children:"Барлығы қатысқан"}),e.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 rounded-xl border border-slate-300 font-semibold",children:"Барлығы қатыспаған"}),e.jsx("button",{onClick:A,className:"px-4 py-2 rounded-xl border border-slate-300 font-semibold",children:"Ескертпе/бағаны тазалау"}),e.jsx("button",{onClick:_,className:"px-4 py-2 rounded-xl bg-indigo-600 text-white font-semibold",children:"JSON экспорт"}),e.jsxs("div",{className:"ml-auto text-sm text-slate-600 self-center",children:["Қатысу: ",e.jsx("b",{children:O})," / ",s.length]})]}),e.jsx("div",{className:"mt-6 overflow-x-auto rounded-2xl border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-50 text-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Оқушы"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Қатысу"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Баға"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Ескертпе"})]})}),e.jsx("tbody",{children:s.map(t=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-3",children:t.name}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.present,onChange:r=>c(t.id,{present:r.target.checked})}),e.jsx("span",{children:t.present?"Қатысты":"Қатыспады"})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"text",value:t.grade,onChange:r=>c(t.id,{grade:r.target.value}),className:"w-24 rounded-lg border border-slate-300 px-2 py-1 outline-none focus:ring-2 focus:ring-indigo-500/60",placeholder:"мыс: 10"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"text",value:t.note,onChange:r=>c(t.id,{note:r.target.value}),className:"w-full rounded-lg border border-slate-300 px-2 py-1 outline-none focus:ring-2 focus:ring-indigo-500/60",placeholder:"қысқа ескерту"})})]},t.id))})]})}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:[e.jsx("h3",{className:"font-bold text-slate-900",children:"Топтық жазба / рефлексия"}),e.jsx("textarea",{rows:6,value:a,onChange:t=>i(t.target.value),className:"mt-2 w-full rounded-xl border border-slate-300 px-3 py-2 outline-none focus:ring-2 focus:ring-purple-500/60",placeholder:"Бүгінгі сабақтағы жалпы байқаулар…"})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4",children:[e.jsx("h3",{className:"font-bold text-slate-900",children:"Ата-анаға қысқа есеп"}),e.jsxs("div",{className:"mt-2 flex gap-2 items-center",children:[e.jsx("label",{className:"text-sm text-slate-600",children:"Оқушы:"}),e.jsx("select",{value:x,onChange:t=>f(Number(t.target.value)),className:"rounded-lg border border-slate-300 px-3 py-2",children:s.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]}),e.jsx("textarea",{readOnly:!0,rows:5,value:L,className:"mt-2 w-full rounded-xl border border-slate-300 px-3 py-2 bg-slate-50"}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"† Осы мәтінді көшіріп, AtaLink арқылы жіберуге болады."})]})]}),e.jsxs("div",{className:"mt-8 rounded-2xl border border-slate-200 bg-white p-4",children:[e.jsx("h3",{className:"font-bold text-slate-900",children:"Мұғалім ресурстары"}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("input",{value:b,onChange:t=>I(t.target.value),onKeyDown:U,placeholder:"іздеу: classroom, steam, methodology…",className:"flex-1 rounded-xl border border-slate-300 px-3 py-2"}),e.jsx("button",{onClick:k,className:"px-4 py-2 rounded-xl bg-emerald-600 text-white font-semibold",children:"Іздеу"})]}),m&&e.jsx("div",{className:"mt-3 text-sm text-slate-500",children:"Жүктелуде…"}),v&&!m&&e.jsx("div",{className:"mt-3 text-sm text-rose-600",children:v}),e.jsxs("div",{className:"mt-4 grid gap-3 md:grid-cols-2",children:[j.map(t=>{const r=T(t.url);return e.jsxs("a",{href:r||void 0,target:"_blank",rel:"noreferrer noopener",className:`block rounded-xl border border-slate-200 p-4 hover:bg-slate-50 ${r?"":"pointer-events-none opacity-60"}`,title:t.url,children:[e.jsx("div",{className:"font-semibold text-slate-900",children:t.title}),t.description&&e.jsx("div",{className:"mt-1 text-sm text-slate-700",children:t.description}),Array.isArray(t.tags)&&t.tags.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:t.tags.map(l=>e.jsxs("span",{className:"text-xs px-2 py-1 rounded-lg bg-slate-100 border border-slate-200",children:["#",l]},l))})]},t.id)}),!m&&j.length===0&&e.jsx("div",{className:"text-sm text-slate-500",children:"Нәтиже жоқ."})]})]})]})}export{Q as default};
//# sourceMappingURL=TeacherConsole-pt1scSWv.js.map
